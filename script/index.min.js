"use strict";$(function(){var o=function(a){return window.matchMedia("(max-width: "+a+")").matches},a=function(a){var e=$("body"),t=void 0;t=a?"height":"width";return{amica:function(){e.append('\n            <div class="container">\n                <div class="amica amica--'+t+'-50">\n                    <div class="amica__center-center">\n                        <img class="amica__center-center__logo" src="./image/amica-brand-logo.png" alt="amica logo">\n                        <a href="" class="amica__center-center__button" title="Check Amica Lunch Options">Enter</a>\n                        <h1 class="amica__center-center__name"><a href=\'http://www.amica.fi/en/restaurants/ravintolat-kaupungeittain/helsinki/helia-bistro.-opetustalo/\' target="_blank">Helia Bistro</a></h1>\n                    </div>\n                </div>\n            </div>\n            ')},haaga:function(){e.append('\n            <div class="container">\n                <div class="haaga haaga--'+t+'-50">\n                    <div class="haaga__center-center">\n                        <img class="haaga__center-center__logo" src="./image/haaga-helia-logo.png" alt="haaga-helia logo">\n                        <a href="" class="haaga__center-center__button" title="Read More Information About Haaga-Helia">Enter</a>\n                        <h1 class="haaga__center-center__name"><a href=\'http://www.haaga-helia.fi/fi/etusivu\' target="_blank">Haaga Helia</a></h1>\n                    </div>\n                </div>\n            </div>\n            ')}}}(o("529px"));a.amica(),a.haaga();var e,t,n,r,c,i,s=function(a){var e=void 0;e="haaga"==a?"<img class='footer__loading' src='./image/loading_icon.gif' alt='Loadingâ€¦' />":"";var t=$("\n            <div class = 'footer'>\n                "+e+"\n                <a class = 'footer__button-"+a+"'>Go Back</a>    \n            </div>\n        ");$("."+a).append(t)},_=function(){return $('<div class="row row__small row__medium row__large"></div>')},l=function(a){var e=new Date,t=e.getDate(),n=e.getMonth()+1;return a&&n<10&&(n="0"+n),e.getFullYear()+"-"+n+"-"+t},h=function(a,e,t,n){o("529px")?(e.attr("class",a+" "+a+"--height-100 "+a+"--overflow"),n.attr("class",t+" "+t+"--height-0")):(e.attr("class",a+" "+a+"--width-100 "+a+"--overflow"),n.attr("class",t+" "+t+"--width-0"))},g=function(a,e,t,n){o("529px")?(e.attr("class",a+" "+a+"--height-50"),n.attr("class",t+" "+t+"--height-50")):(e.attr("class",a+" "+a+"--width-50"),n.attr("class",t+" "+t+"--width-50"))},d={$amicaHome:$(".amica__center-center__button"),$haagaHome:$(".haaga__center-center__button")},m={container:$(".amica"),center:$(".amica__center-center"),center_logo:$(".amica__center-center__logo"),center_name:$(".amica__center-center__name")},u={container:$(".haaga"),center:$(".haaga__center-center"),center_logo:$(".haaga__center-center__logo"),center_name:$(".haaga__center-center__name")},p=(e=l(!1),t="http://www.amica.fi/api/restaurant/menu/week?language=en&restaurantPageId=6143&weekDate="+e,{getRestaurantInfo:function(){return axios.get("http://www.amica.fi/modules/json/json/Index?costNumber=0084&language=en").then(function(a){return a.data}).catch(function(a){$(".amica").append('<div class="error">\n                            <h1>Service Unavailable!</h1>\n                            <p>We cannot connect Amica\'s API because of \'Access-Control-Allow-Origin\'.</p>\n                            <p>However, for Google Chrome users there is an extension called <br>\n                                <a href="https://chrome.google.com/webstore/detail/allow-control-allow-origi/nlfbmbojpeacfghkpbjhddihlkkiljbi?hl=en" target="_blank">Allow-Control-Allow-Origin: *</a>\n                            </p>\n                        </div> '),console.log(a)})},addRestaurantInfo:function(a){return $('<div class="amica__top-center__restaurant-info">\n                        <h1 class="amica__top-center__restaurant-info__name"><a href="'+a.RestaurantUrl+'" target="_blank">'+a.RestaurantName+'</a></h1>\n                        <p class="amica__top-center__restaurant-info__time">Closed!</p>\n                    </div>')},getLunchInfo:function(){return axios.get(t).then(function(a){return a.data}).catch(function(a){console.log(a)})},addLunchInfo:function(a){var e=$('<div class="row__xs-12 row__small-12 row__medium-6 row__large-3"</div>');return""!=a.Html?e.append("<h3>"+a.DayOfWeek+" ("+a.Date+")</h3>",a.Html):e.append("<h3>"+a.DayOfWeek+" ("+a.Date+")</h3>","<p>The Restaurant Closed!</p>"),e},styleInactiveDays:function(){var a=(new Date).getDay();0==a?a=6:a-=1;for(var e=0;e<7;e++)e==a?$(".row > div").eq(e).css({border:"2px solid #007549",padding:"10px","box-shadow":"2px 2px 3px rgba(0,0,0,0.16)"}):$(".row > div").eq(e).css({opacity:".3"})},addOpenClose:function(a){var e=new Date,t=e.getHours(),n=e.getMinutes(),o=$('<p class = "amica__top-center__restaurant-info__isOpen"></p>'),r="OPEN!",c="CLOSED!";10==t?30<=n&&n<=59?o.text(r):o.text(c):11<=t&&t<14?o.text(r):16<=t&&t<18?o.text(r):o.text(c),o.insertAfter(a)}}),f=(n={method:"flickr.photos.search",api_key:"a2cf3fa7a12e171dbd210236313bf095",tags:"haaga-helia",format:"json",perPage:30,currentPage:1,plainJSON:"nojsoncallback=1"},r=function(){return"https://api.flickr.com/services/rest/?method="+n.method+"&api_key="+n.api_key+"&tags="+n.tags+"&per_page="+n.perPage+"&page="+n.currentPage+"&format="+n.format+"&"+n.plainJSON},{getPhotos:function(){n.currentPage=1;var a=r();return axios.get(a).then(function(a){return n.totalPages=a.data.photos.pages,a.data}).catch(function(a){console.log(a)})},buildThumbnailUrl:c=function(a){return"https://farm"+a.farm+".staticflickr.com/"+a.server+"/"+a.id+"_"+a.secret+"_q.jpg"},addContent:i=function(a){var e=a.replace(/_q./,"_c.");return $('<div class="row__xs-12 row__small-4 row__medium-3 row__large-2">\n                        <img src="'+a+'">\n                        <div class="modal">\n                            <div class="modal__container">\n                                <img src="'+e+'">\n                            </div>\n                        </div>                \n                    </div>')},addHaagaInfo:function(){return $('<div class="haaga__top-center__campus-info">\n                        <h1 class="haaga__top-center__campus-info__name"><a href=\'http://www.haaga-helia.fi/fi/etusivu\' target="_blank">Haaga Helia</a></h1>\n                        <p class="haaga__top-center__campus-info__link"></p>\n                    </div>')},createPopUp:function(a){$(a.target).next(".modal").css("display","block")},removePopUp:function(a){var e=$(".modal");event.target==e&&e.css("display","none"),$(a.target).closest(".modal").css("display","none")},infiniteLoading:function(){var a=$(window);$(document).height()-a.height()==Math.ceil(a.scrollTop())&&n.currentPage<n.totalPages&&($(".footer__loading").css("visibility","visible"),function(){n.currentPage+=1;var a=r();return axios.get(a).then(function(a){return a.data}).catch(function(a){console.log(a)})}().then(function(a){var t=$(".row");a.photos.photo.forEach(function(a){var e=c(a);t.append(i(e))}),$(".footer__loading").css("visibility","hidden"),n.currentPage==n.totalPages&&$(".footer").prepend("<p class='footer__info'>"+a.photos.total+" photos loaded.</p>")}))}}),v={amicaHomeButton:function(a){a.preventDefault(),h("amica",m.container,"haaga",u.container),m.center.removeClass("amica__center-center").addClass("amica__top-center"),m.center_logo.removeClass("amica__center-center__logo").addClass("amica__top-center__logo"),d.$amicaHome.add(u.center).add(m.center_name).fadeOut(0),p.getRestaurantInfo().then(function(a){var e=p.addRestaurantInfo(a);$(".amica__top-center").append(e);var t=l(!0),n=$(".amica__top-center__restaurant-info__time");try{a.MenusForDays.forEach(function(a,e){if(-1!=a.Date.search(t))throw n.text(a.LunchTime),p.addOpenClose(n),BreakException;$(".amica__top-center__restaurant-info__isOpen").text("CLOSED!")})}catch(a){if(a!==BreakException)throw a}}).catch(function(a){console.log(a)}),p.getLunchInfo().then(function(a){var t=_();a.LunchMenus.forEach(function(a){var e=p.addLunchInfo(a);t.append(e)}),m.container.append(t),$(".amica td").removeAttr("width valign"),p.styleInactiveDays(),s("amica")})},haagaHomeButton:function(a){a.preventDefault(),h("haaga",u.container,"amica",m.container),u.center.removeClass("haaga__center-center").addClass("haaga__top-center"),u.center_logo.removeClass("haaga__center-center__logo").addClass("haaga__top-center__logo");var e=f.addHaagaInfo();$(".haaga__top-center").append(e),d.$haagaHome.add(m.center).add(u.center_name).fadeOut(0),f.getPhotos().then(function(a){var t=_();a.photos.photo.forEach(function(a){var e=f.buildThumbnailUrl(a);t.append(f.addContent(e))}),u.container.append(t),t.on("click",f.createPopUp),t.on("click",".modal__container",f.removePopUp),t.on("click",".modal",f.removePopUp),s("haaga"),$(".footer").find(".footer__loading").css("visibility","hidden"),$(".haaga").addClass("haaga--relative")})},amicaReturnButton:function(a){a.preventDefault(),g("amica",m.container,"haaga",u.container);var e=$(".amica__top-center"),t=$(".amica__top-center__logo");e.removeClass("amica__top-center").addClass("amica__center-center"),t.removeClass("amica__top-center__logo").addClass("amica__center-center__logo"),$(".footer, .row, .amica__top-center__restaurant-info").remove(),d.$amicaHome.add(u.center).add(m.center_name).fadeIn(0)},haagaReturnButton:function(a){a.preventDefault(),g("haaga",u.container,"amica",m.container),$(".haaga").removeClass("haaga--relative");var e=$(".haaga__top-center"),t=$(".haaga__top-center__logo");e.removeClass("haaga__top-center").addClass("haaga__center-center"),t.removeClass("haaga__top-center__logo").addClass("haaga__center-center__logo"),$(".footer, .row, .haaga__top-center__campus-info").remove(),d.$haagaHome.add(m.center).add(u.center_name).fadeIn(0)}};d.$amicaHome.on("click",v.amicaHomeButton),d.$haagaHome.on("click",v.haagaHomeButton),m.container.on("click",".footer__button-amica",v.amicaReturnButton),u.container.on("click",".footer__button-haaga",v.haagaReturnButton),$(window).on({orientationchange:function(){var a=o("529px");a&&0==screen.orientation.angle?m.container.hasClass("amica--width-50")&&(m.container.attr("class","amica amica--height-50"),u.container.attr("class","haaga haaga--height-50")):a||-90!=screen.orientation.angle&&90!=screen.orientation.angle||m.container.hasClass("amica--height-50")&&(m.container.attr("class","amica amica--width-50"),u.container.attr("class","haaga haaga--width-50"))},scroll:f.infiniteLoading})});